@model System.Data.DataTable
<script src="~/js/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="~/js/textValidate.js"></script>
<script type="text/javascript" src="~/js/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript">
    function PageIndexChange(index, isTiao) {
        var pageIndex = parseInt($("#pageIndex").html());
        var pgCount = parseInt($("#pgCount").select().val());
        var ind = parseInt($("#txtTiao").val());
        var pageProCount = parseInt($("#pageCount").html());
        var log = $("#log").select().val();
        var beginTime = $("#txtBeginTime").val();
        var endTime = $("#txtEndTime").val();
        //alert(log + " " + $("#log").val()+" "+$("#log").select().text());
        if (isTiao) {
            if (ind > pageProCount) {
                $("#txtTiao").val(pageIndex);
                return;
            }
            else {
                var menuId = '@ViewData["menuId"]';
                $.ajax(
                    {
                        type: "POST",
                        url: "/SystemManager/PageIndexChange",
                        data: { pageIndex: ind, pgCount: pgCount, menuId: menuId, log: log, beginTime: beginTime, endTime: endTime },
                        success: function (data) {
                            if (data != "") {
                                var str = data.split("╋");
                                $("#tableBody").html(str[0]);
                                $('#pageCount').html(str[1]);
                                $('#pageRowsCount').html(str[2]);
                                $("#txtTiao").val(ind);
                                $("#pageIndex").html(ind)
                            }
                            else {

                            }
                            return;
                        },
                        error: function (a, b, c) {
                            alert(b);
                        }
                    });
            }
            return;
        }
        switch (index) {
            case 0://首页
                pageIndex = 1;
                break;
            case 1://上一页
                pageIndex = pageIndex - 1;
                break;
            case 2://下一页
                pageIndex = pageIndex + 1;
                break;
            case 3://尾页
                pageIndex = pageProCount;
                break;
        }
        if (index != 0 && (pageIndex <= 0 || pageIndex > pageProCount)) {
            return;
        }
        else {
            var menuId = '@ViewData["menuId"]';
            $.ajax({
                type: "POST",
                url: "/SystemManager/PageIndexChange",
                dataType: "text",
                data: { pageIndex: pageIndex, pgCount: pgCount, menuId: menuId, log: log, beginTime: beginTime, endTime: endTime },
                success: function (data) {
                    if (data != "") {
                        var str = data.split("╋");
                        $("#tableBody").html(str[0]);
                        $('#pageCount').html(str[1]);
                        $('#pageRowsCount').html(str[2]);
                        $("#txtTiao").val(pageIndex);
                        $("#pageIndex").html(pageIndex);
                        return;
                    }
                    else {
                        $("#txtTiao").val(pgIndex);
                    }
                }
            });
        }
    }
    function pgChange() {
        PageIndexChange(0, false);
    }
    function mouseOver(th) {
        $(th).children("div").attr("style", "display:block;left:" + $(th).width() + "px");
    }
    function mouseOut(th) {
        $(th).children("div").attr("style", "display:none;left:0px;");
    }
    function slChange() {
        PageIndexChange(0, false);
    }
    function search1() {
        PageIndexChange(0, false);
    }
</script>
<link href="~/Css/divShow.css" rel="stylesheet" />
<style type="text/css">
    #mytable {
        border: solid #999; /* 设置边框属性；样式(solid=实线)、颜色(#999=灰) */
        border-width: 1px 0 0 1px; /* 设置边框状粗细：上 右 下 左 = 对应：1px 0 0 1px */
        font-size: 12px;
        border: solid 1px #808080;
        width: 98%;
        border-collapse: collapse;
    }

        #mytable caption {
            font-size: 12px;
            font-weight: bolder;
        }

        #mytable th, table td {
            border: solid #999;
            height: 25px;
            border-width: 0 1px 1px 0;
            padding: 2px;
        }

        #mytable td {
            height: 25px;
            width: auto;
            text-align: center;
            position: relative;
        }

    #Div {
        margin-top: 10px;
        width: 100%;
        height: 90%;
        font-size: 12px;
        overflow-x: scroll;
    }

    td div {
        border: 1px solid #808080;
        width: 300px;
        height: auto;
        font: bold 11px #fff;
        top: -10px;
        background-color: #999;
        position: absolute;
        opacity: 1;
        display: none;
        z-index: 999;
    }

    .divShow {
        display: block;
    }

    .divHide {
        display: none;
    }

    .curren {
        cursor: pointer;
    }

    .TimeCss {
        width: 100px;
    }
</style>
<div id="Div">
    <table id="mytable" class="mytable">
        <thead>
            <tr>
                <th colspan="50" style="text-align: left;">
                    <select id="log" onchange="slChange()">
                        <option value="1" selected="selected">所有日志信息</option>
                        <option value="2">更新异常信息</option>
                    </select>
                    时间： 
                    <input type="text" id="txtBeginTime" name="txtBeginTime" onclick="WdatePicker()" class="TimeCss" />--<input class="TimeCss" type="text" id="txtEndTime" name="txtEndTime" onclick="    WdatePicker()" /><button onclick="search1()">搜索</button>
                </th>
            </tr>
            <tr>
                @foreach (System.Data.DataColumn c in Model.Columns)
                {
                    if (c.ColumnName == "编号")
                    {
                        if (ViewData["IsShowId"] != null && bool.Parse(ViewData["IsShowId"].ToString()))
                        {
                    <th>@c.ColumnName</th>
                        }
                    }
                    else
                    {
                    <th>@c.ColumnName</th>
                    }
                }
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            @foreach (System.Data.DataRow r in Model.Rows)
            {
                <tr id="@r["编号"]">
                    @foreach (System.Data.DataColumn c in Model.Columns)
                    {
                        if (c.ColumnName == "编号")
                        {
                            if (ViewData["IsShowId"] != null && bool.Parse(ViewData["IsShowId"].ToString()))
                            {
                        <td>@r[c.ColumnName]</td>
                            }
                        }
                        else
                        {
                            if (r[c.ColumnName].ToString().Length > 20)
                            {
                                string str = r[c.ColumnName].ToString();
                        <td class="curren" onmouseout="mouseOut(this)" onmousemove="mouseOver(this)">@str.Substring(0, 20) ...<div>
                            <p>@str</p>
                        </div>
                        </td>
                        
                            }
                            else
                            {
                        <td>@r[c.ColumnName]</td>
                            }
                        }
                    }
                    @if (ViewData["Delete"].ToString() == "true")
                    {
                        <td><a href="#" onclick="onDelete('@r["编号"]')">删除</a></td>
                    }
                    else
                    {
                        <td>无权限</td>
                    }
                </tr>
            }
        </tbody>
    </table>
</div>
<div style="width: 100%;">
    <span><a href="#" onclick="PageIndexChange(0,false)">首页</a>  <a href="#" onclick="PageIndexChange(1,false)">上一页</a>
        <input type="text" id="txtTiao" name="txtTiao" value="1" style="width: 50px;" onkeyup="IsNumber(this);" />
        <a href="#" onclick="PageIndexChange(4,true)">跳转</a>  <a href="#" onclick="PageIndexChange(2,false)">下一页</a>  <a href="#" onclick="PageIndexChange(3,false)">尾页</a>
        <select id="pgCount" onchange="pgChange()">
            <option value="10">10</option>
            <option value="30">30</option>
            <option value="50">50</option>
        </select>
        共 <span id="pageCount">@ViewData["pageProCount"]</span> 页 当前第 <span id="pageIndex">1</span> 页 共 <span id="pageRowsCount">@ViewData["pageRowsCount"]</span>条数据
    </span>
</div>
