<script src="~/js/jquery-1.8.2.min.js"></script>
<script src="~/js/pageIndex.js"></script>
<link href="~/Css/divShow.css" rel="stylesheet" />
<link href="~/Css/All.css" rel="stylesheet" />
<link href="~/Css/Search.css" rel="stylesheet" />
<script type="text/javascript" src="~/js/My97DatePicker/WdatePicker.js"></script>
<script src="~/js/DropDowndiv.js"></script>


<script type="text/javascript">
    //全选
    function CheckAll() {
        if ($("#CheckAll").attr("checked") == "checked") { // 全选 
            $("input[class=Check]").each(function () {
                $(this).attr("checked", true);
            });
        }
        else { // 取消全选 
            $("input[class=Check]").each(function () {
                $(this).attr("checked", false);
            });
        }
    }
    $(function ()
    {
        $("#Serach").click(function ()
        {
            var Scode = $("#Scode").val();//货号
            var Style = $("#Style").val();//款号
            var PriceMin = $("#PriceMin").val();//最小价格
            var PriceMax = $("#PriceMax").val();//最大价格
            var Season = $("#Season").val();//季节
            var Brand = $("#Brand").val();//品牌
            var StockMin = $("#StcokMin").val();//最小库存
            var StockMax = $("#StcokMax").val();//最大库存
            var TimeMin = $("#MinTime").val();//最小时间
            var TimeMax = $("#MaxTime").val();//最大时间
            var Type = $("#Type").val();//类别
            var Imagefile = $("#Imagefile").val();//是否有图
            var Params = "{Scode:'" + Scode + "', Style:'" + Style + "', PriceMin:'" + PriceMin + "', PriceMax:'" + PriceMax + "', Season:'" + Season + "', Brand:'" + Brand + "', StockMin:'" + StockMin + "', StockMax:'" + StockMax + "'," +
                "TimeMin:'" + TimeMin + "', TimeMax:'" + TimeMax + "', Type:'" + Type + "', Imagefile:'" + Imagefile + "'}";
            $.post("/ShopManager/ShowCheckProduct", {
                menuId: "@ViewData["myMenuId"]",
                pageIndex: 1,
                pageSize: 10,
                params: Params,
            }, function (data) { $("#CheckProductTb").html(""); var ss = data.split("-----"); $("#CheckProductTb").append(ss[0]); $("#PageCount").html(ss[1]); $("#AllCounts").html(ss[2]); showPic(); })

            var b = $.PageFunc("/ShopManager/ShowCheckProduct", "@ViewData["myMenuId"]", Params);
            $("#spanPage").html(b);
            $("#txtTiao").val(1);
            $("#PageNum").html(1);

        })
    })




    //确认选货  确认店铺
    function CheckProduct()
    {
        var Scodes = "";
        var Vencodes = "";
        var ShopId = $("#ThisShop").val() == null ? "" : $("#ThisShop").val();
        if (ShopId == "")
        {
            alert("请选择店铺");
            return false;
        }
        $("input[class=Check]").each(function () {
            if ($(this).attr("checked") == "checked")
            {
                Scodes += "," + $(this).attr("Scode");
                Vencodes += "," + $(this).attr("Vencode");
            }
            
        });
        $.ajax(
            {
                type: "POST",
                datatype: "text",
                url: "/ShopManager/SaveCheckProduct",
                data: {
                    "Scodes": Scodes,
                    "ShopId": ShopId,
                    "Vencodes": Vencodes
                },
                success: function (data)
                {
                    alert(data)
                }
            })
    }
</script>
<style type="text/css">
    #ThisShop {
        font-size:15px;
    }
</style>
<style type="text/css">
    #PopStyledescript
    {
        left: 20%;
        top: 20%;
        width: 1000px;
        min-height: 500px;
    }
        #divMainPicContent, #divMainPicContentStyle, .divStyleContainer
    {
        margin: auto;
        width: 90%;
        min-height: 100px;
        border: 1px solid gray;
        padding: 10px;
        margin-top: 10px;
        text-align: center;
    }

        #divMainPicContent img, #divMainPicContentStyle img, .divStyleContainer img
        {
            width: 75px;
            height: 75px;
        }
            #PopContent #tabProperty
    {
        width: 720px;
    }

        #PopContent #tabProperty td
        {
            border: none;
            width: 33%;
            text-align: right;
        }
            #PopContent
    {
        left: 0%;
        top: 0%;
        width: 1250px;
        height: 805px;
    }
    #divUploadMainPicStyle img
    {
        margin-left:10px;
    }
    #divUploadMainPic, #divShowMianPic, #divUploadMainPicStyle, #divShowMianPicStyle
    {
        float: left;
    }
        #EditContainer
    {
        margin-top: 5px;
        border: 1px solid lightblue;
        height: 765px;
        width: 61%;
        background-color: white;
        padding-top: 15px;
        overflow: auto;
        float: left;
    }
            #divProductInfo
    {
        float: right;
        margin-top: 5px;
        margin-right: 5px;
        border: 1px solid lightblue;
        height: 765px;
        width: 38%;
        background-color: white;
        padding-top: 15px;
        overflow: auto;
    }
</style>
<div style="font-size:15px;">
    <span style="font-size:15px;">选货人:</span><span style="font-size:15px;color:red;"></span>@ViewData["UserName"]  
     &nbsp;&nbsp;
    <span style="font-size:15px;">您的店铺:</span><select id="ThisShop">@Html.Raw(ViewData["ShopName"])</select>
</div>
<div id="QueryBuilder">
    <span class="spanProperty">
        <span class="spanPropertyName">款号：</span>
        <input type='text' id='Style' class="spanPropertyValue">
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">货号：</span>
        <input type='text' id='Scode' class="spanPropertyValue">
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最小价格：</span>
        <input type='text' id='PriceMin' class="spanPropertyValue">
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最大价格：</span>
        <input type='text' id='PriceMax' class="spanPropertyValue" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">品牌：</span>
        <input type="text" id="Brand" class="spanPropertyValue" onclick="GetDropToBrand(this.id)" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">类别：</span>
        <input type="text" id="Type" class="spanPropertyValue" onclick="GetDropToType(this.id)" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">季节：</span>
        <input type='text' id='Season' class="spanPropertyValue"/>
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最小库存：</span>
        <input type='text' class="spanPropertyValue" id='StcokMin'>
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最大库存：</span>
        <input type='text' id='StcokMax' class="spanPropertyValue" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最小时间：</span>
        <input type="text" class="spanPropertyValue" id="MinTime"  onfocus="WdatePicker({isShowWeek:true,onpicked:function() {$dp.$('d122_1').value=$dp.cal.getP('W','W');$dp.$('d122_2').value=$dp.cal.getP('W','WW');}})" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">最大时间：</span>
        <input type="text" class="spanPropertyValue" id="MaxTime"  onfocus="WdatePicker({isShowWeek:true,onpicked:function() {$dp.$('d122_1').value=$dp.cal.getP('W','W');$dp.$('d122_2').value=$dp.cal.getP('W','WW');}})" />
    </span>
    <span class="spanProperty">
        <span class="spanPropertyName">图片状态：</span>
        <select id='Imagefile' class="spanPropertyValue"><option value=''>请选择</option><option value='1'>有</option><option value='2'>无</option></select>
    </span>
    <br />
    <input type='button' id='Serach' class="spanPropertySearch" value='查询' />
    <input type='button' onclick='CheckProduct()' class="spanPropertySearch" value='确认挑货'/>
</div>

<div id="CheckProductTb"></div>
    <div class="divJump" id="divJump">
        <span id="spanPage" style="font-weight:400;"></span>
    共 <span id='PageCount' style='color: blue'></span>页&nbsp;&nbsp;
    当前第 <span id='PageNum' style='color: blue'>1</span> 页&nbsp;&nbsp;
    共 <span id='AllCounts' style='color: blue'></span>条数据
    </div>


<script type="text/ecmascript">
    //查看属性
    function LookAtrrbutt(scode, vencode) {
        $.ajax(
            {
                type: "POST",
                datatype: "text",
                url: "/ShopManager/LookAttrByCheck",
                data: {
                    "scode": scode,
                    "vencode": vencode,
                    "MenuId":"@ViewData["myMenuId"]"
                },
                success: function (data) {
                    var da = data.split('❤');
                    $("#EditContent").empty;
                    $("#divProductInfo").empty;
                    $("#TypeAttribute").empty;
                    $.get("/ShopManager/ShowMainPic", { scode: scode }, function (data) {
                        var da = data.split('-*-');
                        $("#divShowMianPic").html("");
                        for (var i = 0; i < da.length; i++) {
                            $("#divShowMianPic").append("<img style='width:75px;height:75px;' src='" + da[i] + "'/>")
                        }

                    })//主图
                    $("#EditContent").html(da[0]);
                    $("#divProductInfo").html(da[1]);
                    $("#TypeAttribute").html(da[2]);
                    $("#PopContent").show();
                }
            })
    }
    //关闭查看属性
    function CloseDown() {
        $("#PopContent").hide();
    }
</script>
<div class="PopBg"></div>
<div id="PopContent" class="myPopdiv">
    <div class="divclose" onclick="CloseDown()">×</div>
    <div class="Poptitle">商品属性</div>
    <div id="EditContainer">
        <div id="EditContent" style="width: 760px">
        </div>
        <div id="TypeAttribute">
        </div>
        <div>
            <div id="divMainPicContent">
                <div>主图</div>
                <div id="divShowMianPic"></div>
            </div>
            <div id="divImageFile">
                <div id="div_img1">
                    <div id="divScodePic">
                        
                    </div>
                </div>
            </div>
            <div style="width: 100%; text-align: center; margin-top: 20px;">
                <input type="button" value=" 关 闭 " onclick=" CloseDown()" style="margin-left: 20px;" />
            </div>
        </div>
    </div>
    <div id="divProductInfo"></div>
    <div class="divMainMaxPic"></div>
</div>
<script type="text/javascript">
    //鼠标悬停 查看大图
    function showPic(obj) {
        var src = $(obj).attr("src");
        var y = $(obj).offset().top;
        var x = $(obj).offset().left;
        $("#divShowPic").css("top", y - 60);
        $("#divShowPic").css("left", x + 60);
        $("#divShowPic").html("<img src='" + src + "' style='height:200px;width:200px' />")
        $("#divShowPic").show();
    }
    //失去鼠标焦点 隐藏大图
    function HidePic() {
        $("#divShowPic").hide();
    }
</script>

<div id="divShowPic" style="position:absolute"></div>


<script type="text/javascript">

    function selPage(url, menuid, obj) {

        var params = JSON.stringify(obj).replace(/\"/g, "'");
        console.log(obj);
        $.post(url, {
            menuId: menuid,
            pageIndex: 1,
            pageSize: $("#selPages").val(),
            params: params,
        }, function (data) { $("#CheckProductTb").html(""); var ss = data.split("-----"); $("#CheckProductTb").append(ss[0]); $("#PageCount").html(ss[1]); $("#AllCounts").html(ss[2]); })
    }


    $.getDropDownList("#Brand");
    function GetDropToBrand(e) {
        if ($("#" + e).val() == "") {
            sql = 1; //"";
        } else {
            sql = 2;// "select TOP 10 TypeName,Id from Brand where TypeName like " + "'%" + $("#" + e).val() + "%'";
        }

        $.ajax({
            type: "post",
            url: "/Productstock/Brand",
            data: {
                sql: sql,
                value: $("#" + e).val()
            },
            success: function (data) {
                var d1 = eval(data);
                for (i in d1) {
                    $("#dd ul").append("<li title='" + d1[i].BrandAbridge + "'>" + d1[i].BrandName + "")
                }
                getCss(e);
            },
            error: function () {
                alert("error")
            },
        })

    }
    $.getDropDownList("#Type");
    function GetDropToType(e) {
        if ($("#" + e).val() == "") {
            sql = 1; //"";
        } else {
            sql = 2;// "select TOP 10 TypeName,Id from Brand where TypeName like " + "'%" + $("#" + e).val() + "%'";
        }

        $.ajax({
            type: "post",
            url: "/Productstock/Type",
            data: {
                sql: sql,
                value: $("#" + e).val()
            },
            success: function (data) {

                var d1 = eval(data);


                for (i in d1) {
                    $("#dd ul").append("<li title='" + d1[i].TypeNo + "'>" + d1[i].TypeName + "")
                }
                getCss(e);
            },
            error: function () {
                alert("error")
            },
        })
    }
</script>



