<script src="~/js/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="~/js/divShow.js"></script>
<link href="~/Css/divShow.css" rel="stylesheet" />
<link href="~/Css/Search.css" rel="stylesheet" />
<link href="~/Css/All.css" rel="stylesheet" />
<script src="~/js/pageIndex.js"></script>
<style type="text/css">
    a
    {
        text-decoration: none;
    }

        a:hover
        {
            text-decoration: underline;
        }

    #mytable
    {
        min-width: 550px;
    }

        #mytable tr th:first-child
        {
            width: 40px;
        }

        #mytable tr th:nth-child(2)
        {
            width: 150px;
        }

        #mytable tr th:nth-child(3)
        {
            width: 100px;
        }

        #mytable tr th:nth-child(3)
        {
            width: 100px;
        }

        #mytable tr th:nth-child(4)
        {
            width: 100px;
        }

    #PopEditContent, #PopAddTBBrand
    {
        left: 10%;
        top: 10%;
        width: 250px;
        height: 150px;
        padding: 15px;
    }

    .divclose
    {
        position: absolute;
        right: 8px;
        top: 3px;
        cursor: pointer;
        font-size: 2em;
        font-weight: bolder;
        width: 30px;
        height: 30px;
    }

        .divclose:hover
        {
            color: red;
        }


    .divtitle
    {
        color: red;
        font-weight: bold;
        font-size: 1.5em;
    }

    .divContent
    {
        background-color: white;
        border: solid 1px lightblue;
        height: 85%;
    }

    .divHeader
    {
        border: 1px solid #DDDDDD;
        background-color: #F4F4F4;
        height: 30px;
        line-height: 30px;
        padding-left: 15px;
    }
</style>

<div class="divHeader" style="width: 100%; padding: 10px 0px;">
    <span class="spanProperty"><span class="spanPropertyName">品牌名称：</span><input class="spanPropertyValue" id="txtName" type="text"></span>
    <input type="button" value="查  询" onclick="OnSearch()" class="spanPropertySearch" /><input type="button" value="添加品牌" onclick="AddTBBrand()" class="spanPropertySearch" />
</div>
<div style="border: solid 1px lightblue; overflow: hidden">
    <table id="mytable" class="mytable" border="0" cellpadding="0" cellspacing="0">
    </table>
    <div class="divJump">
        <span id="spanPage" style="font-weight: 400;"></span>
        共 <span id='PageCount' style='color: blue'></span>页&nbsp;&nbsp;
    当前第 <span id='PageNum' style='color: blue'>1</span> 页&nbsp;&nbsp;
    共 <span id='AllCounts' style='color: blue'></span>条数据
    </div>
</div>
<div class="PopBg"></div>
<div id="PopEditContent" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div class="divtitle">品牌修改</div>
    <div class="divContent">
        <table>
            <tr>
                <td style="text-align: right;">品牌名：</td>
                <td>
                    <input type="text" id="txtTBBrandName" /></td>
            </tr>
            <tr>
                <td style="text-align: right;">淘宝编号：</td>
                <td>
                    <input type="text" id="txtTBvid" /></td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <input type="button" onclick="SaveBrand()" value="保存" /></td>
            </tr>
        </table>
    </div>
</div>
<div id="PopAddTBBrand" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div class="divtitle">品牌添加</div>
    <div class="divContent">
        <table>
            <tr>
                <td style="text-align: right;">品牌名：</td>
                <td>
                    <input type="text" id="txtAddTBBrandName" /></td>
            </tr>
            <tr>
                <td style="text-align: right;">淘宝编号：</td>
                <td>
                    <input type="text" id="txtAddTBvid" /></td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <input type="button" onclick="AddBrand()" value="保存" /></td>
            </tr>
        </table>
    </div>
</div>

<script type="text/javascript">
    function OnSearch() {//---搜索
        var Name = $("#txtName").val().trim();
        var params = "{Name:'" + Name + "'}";

        $.post("/Brand/SearchTBBrand", {
            menuId: "@ViewData["myMenuId"]",
            pageIndex: 1,
            pageSize: 10,
            params: params
        }, function (data) {
            $("#mytable").html("");
            var ss = data.split("-----");
            $("#mytable").append(ss[0]);
            $("#PageCount").html(ss[1]);
            $("#AllCounts").html(ss[2]);
        });

        var b = $.PageFunc("/Brand/SearchTBBrand", "@ViewData["myMenuId"]", params);
        $("#spanPage").html(b);
        $("#txtTiao").val(1);
        $("#PageNum").html(1);
    }
    
    function selPage(url, menuid, obj) {
        var params = JSON.stringify(obj).replace(/\"/g, "'");
        $.post(url, {
            menuId: menuid,
            pageIndex: 1,
            pageSize: $("#selPages").val(),
            params: params
        }, function (data) {
            $("#mytable").html("");
            var ss = data.split("-----");
            $("#mytable").append(ss[0]);
            $("#PageCount").html(ss[1]);
            $("#AllCounts").html(ss[2]);
        });
    };
        //---弹出编辑页面
        function Edit(TBBrandName, vid, Id) {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopEditContent").show();
            $("#txtTBBrandName").val(TBBrandName);
            $("#txtTBBrandName").attr("title", Id);
            $("#txtTBvid").val(vid);
        }
        //---删除淘宝品牌
        function Delete(TBBrandName, vid, Id) {
            $.MsgBox.Confirm("提示", "确定要删除吗!", function () {
                $.ajax({
                    type: "GET",
                    url: "/Brand/DeleteTBBrand?TBBrandName=" + TBBrandName + "&vid=" + vid + "&Id=" + Id,
                    success: function (data) {
                        if (data == "") {
                            OnSearch();
                            //GetTable($("#selPages").val(), $("#txtTiao").val())
                        }
                        else {
                            $.MsgBox.Alert("提示", data);
                        }
                    },
                    error: function () {
                        alert("error!")
                    },
                })
            })
        }
        //---关闭弹出窗
        function Close() {
            $(".PopBg").hide();
            $(".myPopdiv").hide();
        }
        //---更新品牌
        function SaveBrand() {
            var BrandName = $("#txtTBBrandName").val().trim();
            var vid = $("#txtTBvid").val().trim();
            var Id = $("#txtTBBrandName").attr("title");
            $.ajax({
                type: "GET",
                url: "/Brand/UpdateTBBrand?TBBrandName=" + BrandName + "&vid=" + vid + "&Id=" + Id,
                success: function (data) {
                    $.MsgBox.Alert("提示", data);
                    OnSearch();
                    //GetTable($("#selPages").val(), $("#txtTiao").val())
                },
                error: function () {
                    alert("error!")
                },
            })
        }
        //---添加品牌窗口
        function AddTBBrand() {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopAddTBBrand").show();
            $("#txtAddTBBrandName").val("");
            $("#txtAddTBvid").val("");
        }
        //---确定添加品牌
        function AddBrand() {
            var BrandName = $("#txtAddTBBrandName").val().trim();
            var vid = $("#txtAddTBvid").val().trim();
            $.ajax({
                type: "GET",
                url: "/Brand/AddTBBrand?BrandName=" + BrandName + "&vid=" + vid,
                success: function (data) {
                    $.MsgBox.Alert("提示", data);
                    OnSearch();
                    //GetTable($("#selPages").val(), $("#txtTiao").val())
                },
                error: function () {
                    alert("error!")
                },
            })
        }
</script>
