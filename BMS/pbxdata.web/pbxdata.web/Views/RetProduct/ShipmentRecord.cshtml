<script src="~/js/jquery-1.8.2.min.js"></script>
<script src="~/js/divShow.js"></script>
<link href="~/Css/divShow.css" rel="stylesheet" />
<style type="text/css">
    *
    {
        margin: 0px;
        padding: 0px;
    }

    header
    {
        border: 1px solid #DDDDDD;
        background-color: #F4F4F4;
        padding: 5px;
    }

        header input
        {
            height: 20px;
        }

        header li
        {
            float: left;
            margin-left: 5px;
            margin-top: 7px;
        }

        header a
        {
            display: inline-block;
            height: 22px;
            width: 70px;
            text-align: center;
            line-height: 20px;
            text-decoration: none;
            border-radius: 5px;
        }

            header a:hover
            {
                border: 1px solid lightblue;
                height: 20px;
                border-radius: 5px;
                color: red;
            }

    .divContainer
    {
        border: solid 1px lightblue;
        overflow: hidden;
    }

    .divclose
    {
        position: absolute;
        right: 8px;
        top: 3px;
        cursor: pointer;
        font-size: 2em;
        font-weight: bolder;
        width: 30px;
        height: 30px;
    }

        .divclose:hover
        {
            color: red;
        }

    #PopEditContent, #PopAddContent
    {
        left: 30%;
        top: 25%;
        min-height: 200px;
    }

    .PopContent
    {
        min-height: 100px;
        width: 710px;
    }

    .btnClose
    {
        margin-left: 15px;
    }

    .PopContent li
    {
        margin-top: 5px;
        text-align: right;
        width: 220px;
        float: left;
    }

        .PopContent li input
        {
            width: 150px;
            height: 20px;
        }

    .PopContent select
    {
        width: 150px;
    }
     .mytable td:last-child a
    {
        margin-left: 10px;
    }
        .mytable td:last-child a:last-child
        {
            margin-right:10px;
        }
    .mytable a
    {
        text-decoration: none;
    }

        .mytable a:hover
        {
            color: red;
        }
      .liRemark
    {
        clear:both;text-align:left !important;
    }
        .liRemark textarea
        {
            width:300%;height:50px;
        }
</style>

<header id="SearchHeader">
    @* <input type="text" id="txtSearchOrderId" />
    <input type="button" onclick="OnSearch()" value=" 查  询 " /><a href="#" onclick="AddClick()" style="margin-left: 10px">添    加</a>*@
</header>
<div id="divContainer">
    <table id="mytable" class="mytable" border="0" cellpadding="0" cellspacing="0">
    </table>
    <div class="divJump" style="">
        <select id="selPages" onchange="selPage()">
            <option>1</option>
            <option>5</option>
            <option selected="selected">10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
        </select>
        <a href="#" onclick="TurnPage(1)">首页</a>
        <a href="#" onclick="TurnPage(2)">上一页</a>
        <input type="text" id="txtTiao" name="txtTiao" value="1" style="width: 35px;" onkeyup="OnTiaoChange();" />
        <a href="#" onclick="TurnPage(3)">下一页</a>
        <a href="#" onclick="TurnPage(4)">尾页</a>
        @*@Html.TextBox("txtTiao","", new { style = "width:20px;", onkeyup = "OnTiaoChange();" })*@
        <a href="#" onclick="TurnPage(5)">跳转</a>
        共<span id="PageCount" ></span>页&nbsp;&nbsp;当前第<span id="PageNum" ></span>页&nbsp;&nbsp;共<span id="AllCounts" ></span>条数据
    </div>
</div>
<div id="PopAddContent" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">添加出货记录</div>
    <div class="PopContent">
        <ul>
            <li>订单编号:<input type="text" id="txtAddOrderId" /></li>
            <li>换货金额:<input type="text" id="txtAddExPrice" /></li>
            <li>质量等级:<input type="text" id="txtAddQuaLevel" /></li>
            <li>发货时间:<input type="date" id="txtAddSendTime" /></li>
            <li>快递公司:<input type="text" id="txtAddExpress" /></li>
            <li>快递单号:<input type="text" id="txtAddExpressNo" /></li>
            <li>运费HKD:<input type="text" id="txtAddYFHKD" /></li>
            <li>运费RMB:<input type="text" id="txtAddYFRMB" /></li>
            <li>退货说明:<input type="text" id="txtAddRetRemark" /></li>
            <li>发货人:<input type="text" id="txtAddSendPerson" /></li>
            <li>出货类型:<input type="text" id="txtAddSendType" /></li>
            <li>发货状态:<input type="text" id="txtAddSendStatus" /></li>
        </ul>
        <div class="clearfix"></div>
        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveAdd()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="    Close()" />
        </div>
    </div>
</div>
<div id="PopEditContent" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">修改出货记录</div>
    <div class="PopContent">

        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveEdit()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="    Close()" />
        </div>
    </div>
</div>
<div class="PopBg"></div>
<script type="text/javascript">
    /*搜索权限*/
    $.post("/RetProduct/GetSearchlistRecord", { "menuId": "@ViewData["myMenuId"]" }, function (data) { $("#SearchHeader").html(data); });

    /*搜索*/
    function OnSearch() {
        GetTable(1, $("#selPages").val().trim());
        $("#txtTiao").val(1);
        $("#PageNum").html(1);
    }

    /*获得table*/
    function GetTable(obj, selpages) {
        var lists = [];
        lists.push($("#txtSearchOrderId").val()== null ? "" : $("#txtSearchOrderId").val().trim())
        lists.push($("#txtSearchExPrice").val() == null ? "" : $("#txtSearchExPrice").val().trim())
        //lists.push($("#txtSearchQuaLevel").val() == null ? "" : $("#txtSearchQuaLevel").val().trim())
        lists.push($("#txtSearchSendTime").val() == null ? "" : $("#txtSearchSendTime").val().trim())
        lists.push($("#txtSearchSendTime1").val() == null ? "" : $("#txtSearchSendTime1").val().trim())
        lists.push($("#txtSearchExpress").val() == null ? "" : $("#txtSearchExpress").val().trim())
        lists.push($("#txtSearchExpressNo").val() == null ? "" : $("#txtSearchExpressNo").val().trim())
        lists.push($("#txtSearchSendPerson").val() == null ? "" : $("#txtSearchSendPerson").val().trim())
        lists.push($("#txtSearchSendType").val() == null ? "" : $("#txtSearchSendType").val().trim())
        lists.push($("#txtSearchSendStatus").find("option:selected").val() == null ? "" : $("#txtSearchSendStatus").find("option:selected").val())
        $.ajax({
            type: "get",
            url: "/RetProduct/SearchShipmentRecord",
            data: { "menuId": "@ViewData["myMenuId"]", "lists": lists.join(","), "page": obj, "selpages": selpages },
            success: function (data) {
                selpages = selpages * 1;
                var tabledata = [];
                var tabledata = data.split("-*-");
                $("#mytable").html(tabledata[0]);
                $("#AllCounts").html(tabledata[1])
                $("#PageCount").html(Math.ceil(tabledata[1] * 1 / selpages))

            },
            error: function () {
                alert("error")
            },
        })

    }
    function selPage() {//---------设置显示数目
        $("#txtTiao").val(1);
        $("#PageNum").html(1);
        GetTable(1, $("#selPages").val().trim())
    }
    /*跳转*/
    function TurnPage(obj) {//-----翻页---
        var pages = $("#selPages").val().trim();
        switch (obj) {
            case 1: GetTable(1, pages);//----首页
                $("#txtTiao").val(1);
                $("#PageNum").html(1)
                break;
            case 2:;//----上一页
                if ($("#txtTiao").val().trim() == "1") {
                    return false;
                }
                else {
                    GetTable($("#txtTiao").val().trim() * 1 - 1, pages)
                    $("#txtTiao").val($("#txtTiao").val().trim() * 1 - 1);
                    $("#PageNum").html($("#txtTiao").val().trim())
                }
                break;
            case 3://----下一页
                if ($("#txtTiao").val().trim() == $("#PageCount").html()) {
                    return false;
                }
                else {
                    GetTable($("#txtTiao").val().trim() * 1 + 1, pages);
                    $("#txtTiao").val($("#txtTiao").val().trim() * 1 + 1);
                    $("#PageNum").html($("#txtTiao").val().trim())
                }

                break;
            case 4: GetTable($("#PageCount").html(), pages);//----尾页

                $("#txtTiao").val($("#PageCount").html());
                $("#PageNum").html($("#PageCount").html())
                break;
            case 5: GetTable($("#txtTiao").val().trim(), pages);//----跳转
                $("#PageNum").html($("#txtTiao").val().trim());

                break;

        }
    }

    /*关闭按钮取消修改*/
    function Close() {
        $(".PopBg").hide();
        $(".myPopdiv").hide();
    }

    ///*添加按钮*/
    //function AddClick() {
    //    $(".PopBg").height($(document).height());
    //    $(".PopBg").show();
    //    $("#PopAddContent").show();
    //    $(".PopContent").find("input[type=text]").val("");
    //}

    /*确定添加*/
    function SaveAdd() {
        var list = [];
        list.push($("#txtAddOrderId").val().trim());
        list.push($("#txtAddExPrice").val().trim());
        list.push($("#txtAddQuaLevel").val().trim());
        list.push($("#txtAddSendTime").val().trim());
        list.push($("#txtAddExpress").val().trim());
        list.push($("#txtAddExpressNo").val().trim());
        list.push($("#txtAddYFHKD").val().trim());
        list.push($("#txtAddYFRMB").val().trim());
        list.push($("#txtAddRetRemark").val().trim());
        list.push($("#txtAddSendPerson").val().trim());
        list.push($("#txtAddSendType").val().trim());
        list.push($("#txtAddSendStatus").val().trim());

        $.post("/RetProduct/AddRecord", { "list": list }, function (data) { $.MsgBox.Alert("提示", data); GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim()); })
    }

    /*编辑按钮*/
    function EditRecord(Id) {
        $(".PopBg").height($(document).height());
        $(".PopBg").show();
        $("#PopEditContent").show();
        $.post("/RetProduct/EditRecord", { "Id": Id }, function (data) { $("#PopEditContent").find(".PopContent").html(data) })
    }

    /*确定修改*/
    function SaveEdit() {
        var list = [];
        list.push($("#txtEditOrderId").attr("title"));
        list.push($("#txtEditOrderId").val().trim());
        list.push($("#txtEditExPrice").val().trim());
        //list.push($("#txtEditQuaLevel").val().trim());
        list.push($("#txtEditSendTime").val().trim());
        list.push($("#txtEditExpress").val().trim());
        list.push($("#txtEditExpressNo").val().trim());
        list.push($("#txtEditYFHKD").val().trim());
        list.push($("#txtEditYFRMB").val().trim());
        list.push($("#txtEditRetRemark").val().trim());
        list.push($("#txtEditSendPerson").val().trim());
        list.push($("#txtEditSendType").val().trim());
        list.push($("#txtEditSendStatus").val().trim());
        $.post("/RetProduct/SaveEditRecord", { "list": list }, function (data) { $.MsgBox.Alert("提示", data); GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim()); })
    }

    /*删除按钮*/
    function DeleteRecord(Id) {
        $.MsgBox.Confirm("提示", "确定要删除吗?", function () {
            $.post("/RetProduct/DeleteRecord", { "Id": Id }, function (data) { if (data != "") { $.MsgBox.Alert("提示", data); } GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim()); })
        })
    }

    /*更新交易状态*/
    function UpdateSalesState(OrderId) {
        $.post("/RetProduct/UpdateSalesState", { OrderId: OrderId }, function (data) { $.MsgBox.Alert("提示", data); GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim()); })
    }
</script>
