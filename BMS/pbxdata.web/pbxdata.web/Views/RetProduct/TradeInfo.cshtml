<script src="~/js/jquery-1.8.2.min.js"></script>
<script src="~/js/divShow.js"></script>
<link href="~/Css/divShow.css" rel="stylesheet" />
<style type="text/css">
    *
    {
        margin: 0px;
        padding: 0px;
    }



    header
    {
        border: 1px solid #DDDDDD;
        background-color: #F4F4F4;
        padding: 5px;
    }

        header input
        {
            height: 20px;
        }

        header li
        {
            float: left;
            margin-left: 5px;
            margin-top: 7px;
        }

        header a
        {
            display: inline-block;
            height: 22px;
            width: 70px;
            text-align: center;
            line-height: 20px;
            text-decoration: none;
            border-radius: 5px;
        }

            header a:hover
            {
                border: 1px solid lightblue;
                height: 20px;
                border-radius: 5px;
                color: red;
            }

    .divContainer
    {
        border: solid 1px lightblue;
        overflow: hidden;
    }

    .divclose
    {
        position: absolute;
        right: 8px;
        top: 3px;
        cursor: pointer;
        font-size: 2em;
        font-weight: bolder;
        width: 30px;
        height: 30px;
    }

        .divclose:hover
        {
            color: red;
        }

    #EditTrade, #PopAddContent, #EditProductInfo, #PopAddContent1, #PopAddGoods, #PopAddGoods1
    {
        left: 30%;
        top: 25%;
    }

    .PopContent
    {
        min-height: 100px;
        width: 710px;
    }

    .btnClose
    {
        margin-left: 15px;
    }

    .PopContent li
    {
        margin-top: 5px;
        text-align: right;
        width: 220px;
        float: left;
    }

        .PopContent li input
        {
            width: 150px;
            height: 20px;
        }

    select
    {
        height: 20px;
        width: 150px;
    }

    .mytable img
    {
        width: 60px;
        height: 60px;
    }

    .mytable td:last-child a
    {
        margin-left: 10px;
    }
        .mytable td:last-child a:last-child
        {
            margin-right:10px;
        }
    .mytable a
    {
        text-decoration: none;
    }

        .mytable a:hover
        {
            color: red;
        }

    #divShowPic
    {
        position: absolute;
    }
    #selPages, #selPages1
    {
        width:50px;
    }
    .liRemark
    {
        clear:both;
        text-align:left !important;
    }
        .liRemark textarea
        {
            width:300%;height:50px;
        }
</style>
<h2>交易信息</h2>
<header id="SearchHeader">
</header>
<div id="divContainer">
    <table id="mytable" class="mytable" border="0" cellpadding="0" cellspacing="0">
    </table>
    <div class="divJump" style="">
        <select id="selPages" onchange="selPage()">
            <option>1</option>
            <option>5</option>
            <option selected="selected">10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
        </select>
        <a href="#" onclick="TurnPage(1)">首页</a>
        <a href="#" onclick="TurnPage(2)">上一页</a>
        <input type="text" id="txtTiao" name="txtTiao" value="1" style="width: 35px;" onkeyup="OnTiaoChange();" />
        <a href="#" onclick="TurnPage(3)">下一页</a>
        <a href="#" onclick="TurnPage(4)">尾页</a>
        @*@Html.TextBox("txtTiao","", new { style = "width:20px;", onkeyup = "OnTiaoChange();" })*@
        <a href="#" onclick="TurnPage(5)">跳转</a>
        共<span id="PageCount" ></span>页&nbsp;&nbsp;当前第<span id="PageNum" ></span>页&nbsp;&nbsp;共<span id="AllCounts" ></span>条数据&nbsp;&nbsp;总金额为<span id="AllPrices" ></span>￥
    </div>
</div>
<div id="PopAddContent" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">添加交易信息</div>
    <div class="PopContent">
        <ul>
            <li>订单编号:<input type="text" id="txtAddOrderId" /></li>
            @*<li>系统单号:<input type="text" id="txtAddSystemId" /></li>*@
            @*<li>成交总金额:<input type="text" id="txtAddSellPrice" /></li>*@
            @*<li>交易状态:<input type="text" id="txtAddSaleStates" /></li>*@
            <li>评价状态:<input type="text" id="txtAddEvaluate" /></li>
            @*<li>客服:<input type="text" id="txtAddServiceId" /></li>*@
            <li>下单日期:<input type="date" id="txtAddOrderTime" /></li>
            <li>客户:<input type="text" id="txtAddCustomerId" /></li>
            <li>店铺/平台:<input type="text" id="txtAddShop" /></li>
            <li>联系人:<input type="text" id="txtAddContactperson" /></li>
            <li>电话:<input type="text" id="txtAddTelephone" /></li>
            <li>手机号:<input type="text" id="txtAddPhone" /></li>
            <li>微信:<input type="text" id="txtAddWeixin" /></li>
            <li>QQ:<input type="text" id="txtAddQQNo" /></li>
            <li>省:<input type="text" id="txtAddProvinces" /></li>
            <li>市:<input type="text" id="txtAddCity" /></li>
            <li>发货地址:<input type="text" id="txtAddCusAddress" /></li>
            <li>支付平台:<input type="text" id="txtAddPayment" /></li>
            <li>支付账号:<input type="text" id="txtAddAccount" /></li>
            <li class="liRemark">备注:<textarea  id="txtAddServiceRemark"></textarea></li>
        </ul>
        <div class="clearfix"></div>
        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveAdd()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="    Close()" />
        </div>
    </div>
</div>
<div id="PopAddGoods" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">添加退货退款信息</div>
    <div class="PopContent">
        <div>
            订单编号:<label id="LabOrderId" style="color: red; font-weight: bold"></label>
            货号<label id="LabScode" style="color: red; font-weight: bold"></label>
        </div>
        <ul>
            <li>退款金额:<input type="text" id="txtAddRetPrice" /></li>
            @*  <li>质量等级:<input type="text" id="txtAddQuaLevel" /></li>
            <li>收货时间:<input type="date" id="txtAddRetTime" /></li>*@
            @*<li>快递公司:<input type="text" id="txtAddExpress" /></li>
            <li>快递单号:<input type="text" id="txtAddExpressNo" /></li>*@
            <li>退货类型:<input type="text" id="txtAddRetType" disabled="disabled" /></li>
            <li>退货理由:<select id="txtAddReason">
                <option value="">请选择</option>
                <option value="1">七天无理由</option>
                <option value="2">有色差</option>
                <option value="3">其他</option>
            </select></li>
            @*<li>收货人:<input type="text" id="txtAddReceiver" /></li>*@
            <li>退款账号:<input type="text" id="txtAddRetAccount" /></li>
            <li class="liRemark" >退货说明:
                 <textarea id="txtAddRetDetails" ></textarea>
            </li>
        </ul>
        <div class="clearfix"></div>
        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveGoods()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="Close()" />
        </div>
    </div>
</div>
<div id="PopAddGoods1" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">添加发货信息</div>
    <div class="PopContent">
        <div>
            订单编号:<label id="LabOrderId1" style="color: red; font-weight: bold"></label>
            货号<label id="LabScode1" style="color: red; font-weight: bold"></label>
        </div>
        <ul>
            <li>货物金额:<input type="text" id="txtAddExPrice1" /></li>
            <li>发货时间:<input type="date" id="txtAddSendTime1" /></li>
            <li>快递公司:<input type="text" id="txtAddExpress1" /></li>
            <li>快递单号:<input type="text" id="txtAddExpressNo1" /></li>
            <li>运费HKD:<input type="text" id="txtAddYFHKD1" /></li>
            <li>运费RMB:<input type="text" id="txtAddYFRMB1" /></li>
            <li>发货人:<input type="text" id="txtAddSendPerson1" /></li>
            <li>出货类型:<input type="text" id="txtAddSendType1" disabled="disabled" /></li>
            @*<li>出货类型:<select id="txtAddSendType1">
                <option value="">请选择</option>
                <option value="退货退款">退货退款</option>
                <option value="退款(补偿)">退款(补偿)</option>
            </select></li>*@
            <li>发货状态:<input type="text" id="txtAddSendStatus1" /></li>
            <li class="liRemark">退货说明:
                <textarea id="txtAddRetRemark1"></textarea>
            </li>

        </ul>
        <div class="clearfix"></div>
        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveGoods1()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="    Close()" />
        </div>
    </div>
</div>
<div id="EditTrade" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">编辑交易信息</div>
    <div class="PopContent">
    </div>
</div>
<h2>商品列表</h2>
<header id="SearchHeader1">
    @* 订单编号:<input type="text" id="txtSearchOrderId1" />
    <input type="button" onclick="OnSearch1()" value=" 查  询 " /><a href="#" onclick="AddClick1()" style="margin-left: 10px">添    加</a>*@
</header>
<div id="divContainer1">
    <table id="mytable1" class="mytable" border="0" cellpadding="0" cellspacing="0">
    </table>
    <div class="divJump" style="">
        <select id="selPages1" onchange="selPage1()">
            <option>1</option>
            <option>5</option>
            <option selected="selected">10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
        </select>
        <a href="#" onclick="TurnPage1(1)">首页</a>
        <a href="#" onclick="TurnPage1(2)">上一页</a>
        <input type="text" id="txtTiao1" name="txtTiao" value="1" style="width: 35px;" onkeyup="OnTiaoChange();" />
        <a href="#" onclick="TurnPage1(3)">下一页</a>
        <a href="#" onclick="TurnPage1(4)">尾页</a>
        @*@Html.TextBox("txtTiao","", new { style = "width:20px;", onkeyup = "OnTiaoChange();" })*@
        <a href="#" onclick="TurnPage1(5)">跳转</a>
        共<span id="PageCount1" ></span>页&nbsp;&nbsp;当前第<span id="PageNum1" ></span>页&nbsp;&nbsp;共<span id="AllCounts1" ></span>条数据
    </div>
</div>
<div id="PopAddContent1" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">添加商品信息</div>
    <div class="PopContent">
        <ul>
            <li>订单编号:<input type="text" id="txtAddOrderId1" disabled="disabled" /></li>
            <li>系统单号:<input type="text" id="txtAddSystemId" /></li>
            <li>货品编号:<input type="text" id="txtAddScode" /></li>
            <li>数量:<input type="text" id="txtAddNumber" /></li>
            <li>商品描述:<input type="text" id="txtAddProDetails" /></li>
            <li>商品链接:<input type="text" id="txtAddProLink" /></li>
            <li>发货属性:<input type="text" id="txtAddDeliveryAttri" /></li>
            <li>上次订单号:<input type="text" id="txtAddLastOrderId" /></li>
            <li>成交金额:<input type="text" id="txtAddSellPrice" /></li>
            <li>出货仓:<input type="text" id="txtAddWarehouse" /></li>
        </ul>
        <div class="clearfix"></div>
        <div style="margin-top: 10px;">
            <input type="button" value=" 保   存 " onclick="SaveAdd1()" /><input type="button" class="btnClose" value=" 关   闭 " onclick="    Close()" />
        </div>
    </div>
</div>
<div id="EditProductInfo" class="myPopdiv">
    <div class="divclose" onclick="Close()">×</div>
    <div style="text-indent: 10px; text-align: left;">编辑商品信息</div>
    <div class="PopContent">
    </div>
</div>
<div class="PopBg"></div>
<div id="divShowPic" class="divShowPic"></div>
<script type="text/javascript">
    /*搜索权限*/
    $.post("/RetProduct/GetSearchlistTrade", { "menuId": "@ViewData["myMenuId"]" }, function (data) { $("#SearchHeader").html(data); })

    /*搜索*/
    function OnSearch() {
        GetTable(1, $("#selPages").val().trim());
        $("#txtTiao").val(1);
        $("#PageNum").html(1);
    }

    /*获得table*/
    function GetTable(obj, selpages) {
        var lists = [];
        lists.push($("#txtSearchOrderId").val() == null ? "" : $("#txtSearchOrderId").val().trim())
        //lists.push($("#txtSearchSystemId").val() == null ? "" : $("#txtSearchSystemId").val().trim())
        lists.push($("#txtSearchSellPrice").val() == null ? "" : $("#txtSearchSellPrice").val().trim())
        lists.push($("#txtSearchSaleStates").find("option:selected").val() == null ? "" : $("#txtSearchSaleStates").find("option:selected").val())
        lists.push($("#txtSearchEvaluate").val() == null ? "" : $("#txtSearchEvaluate").val().trim())
        lists.push($("#txtSearchServiceId").val() == null ? "" : $("#txtSearchServiceId").val().trim())
        lists.push($("#txtSearchOrderTime").val() == null ? "" : $("#txtSearchOrderTime").val().trim())
        lists.push($("#txtSearchOrderTime1").val() == null ? "" : $("#txtSearchOrderTime1").val().trim())
        lists.push($("#txtSearchCustomerId").val() == null ? "" : $("#txtSearchCustomerId").val().trim())
        lists.push($("#txtSearchShop").val() == null ? "" : $("#txtSearchShop").val().trim())
        lists.push($("#txtSearchPayment").val() == null ? "" : $("#txtSearchPayment").val().trim())
        lists.push($("#txtSearchAccount").val() == null ? "" : $("#txtSearchAccount").val().trim())
        $.ajax({
            type: "get",
            url: "/RetProduct/SearchRtnPro",
            data: { "menuId": "@ViewData["myMenuId"]", "lists": lists.join(","), "page": obj, "selpages": selpages },
            success: function (data) {
                selpages = selpages * 1;
                var tabledata = [];
                var tabledata = data.split("-*-");
                $("#mytable").html(tabledata[0]);
                $("#AllCounts").html(tabledata[1].split("-")[0])
                $("#PageCount").html(Math.ceil(tabledata[1].split("-")[0] * 1 / selpages))
                $("#AllPrices").html(tabledata[1].split("-")[1])

            },
            error: function () {
                alert("error")
            },
        })

    }
    function selPage() {//---------设置显示数目
        $("#txtTiao").val(1);
        $("#PageNum").html(1);
        GetTable(1, $("#selPages").val().trim())
    }
    /*跳转*/
    function TurnPage(obj) {//-----翻页---
        var pages = $("#selPages").val().trim();
        switch (obj) {
            case 1: GetTable(1, pages);//----首页
                $("#txtTiao").val(1);
                $("#PageNum").html(1)
                break;
            case 2:;//----上一页
                if ($("#txtTiao").val().trim() == "1") {
                    return false;
                }
                else {
                    GetTable($("#txtTiao").val().trim() * 1 - 1, pages)
                    $("#txtTiao").val($("#txtTiao").val().trim() * 1 - 1);
                    $("#PageNum").html($("#txtTiao").val().trim())
                }
                break;
            case 3://----下一页
                if ($("#txtTiao").val().trim() == $("#PageCount").html()) {
                    return false;
                }
                else {
                    GetTable($("#txtTiao").val().trim() * 1 + 1, pages);
                    $("#txtTiao").val($("#txtTiao").val().trim() * 1 + 1);
                    $("#PageNum").html($("#txtTiao").val().trim())
                }

                break;
            case 4: GetTable($("#PageCount").html(), pages);//----尾页

                $("#txtTiao").val($("#PageCount").html());
                $("#PageNum").html($("#PageCount").html())
                break;
            case 5: GetTable($("#txtTiao").val().trim(), pages);//----跳转
                $("#PageNum").html($("#txtTiao").val().trim());

                break;

        }
    }

    /*关闭按钮取消修改*/
    function Close() {
        $(".PopBg").hide();
        $(".myPopdiv").hide();
    }

    function AddClick() {
        $(".PopBg").height($(document).height());
        $(".PopBg").show();
        $("#PopAddContent").show();
        $(".PopContent").find("input[type=text]").val("");
    }

    /*保存添加交易信息*/
    function SaveAdd() {
        var list = [];
        list.push($("#txtAddOrderId").val().trim());
        list.push($("#txtAddEvaluate").val().trim());
        list.push($("#txtAddServiceId").val().trim());
        list.push($("#txtAddServiceRemark").val().trim());
        list.push($("#txtAddOrderTime").val().trim());
        list.push($("#txtAddCustomerId").val().trim());
        list.push($("#txtAddShop").val().trim());
        list.push($("#txtAddContactperson").val().trim());
        list.push($("#txtAddTelephone").val().trim());
        list.push($("#txtAddPhone").val().trim());
        list.push($("#txtAddWeixin").val().trim());
        list.push($("#txtAddQQNo").val().trim());
        list.push($("#txtAddProvinces").val().trim());
        list.push($("#txtAddCity").val().trim());
        list.push($("#txtAddCusAddress").val().trim());
        list.push($("#txtAddPayment").val().trim());
        list.push($("#txtAddAccount").val().trim());
        $.ajax({
            type: "POST",
            url: "/RetProduct/AddTradeInfo",
            data: { "list": list },
            success: function (data) {
                $.MsgBox.Alert("提示", data);
                GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim());
            },
            error: function () {
            }
        })
    }

    /*编辑交易信息表*/
    function EditTrade(OrderId) {
        $(".PopBg").height($(document).height());
        $(".PopBg").show();
        $("#EditTrade").show();
        $.post("/RetProduct/GetEditInfo", { "OrderId": OrderId }, function (data) { $("#EditTrade").find(".PopContent").html(data) })
    }

    /*保存编辑交易信息表*/
    function SaveTradeEdit() {
        var list = [];
        list.push($("#txtEditOrderId").val().trim());
        //list.push($("#txtEditSystemId").val().trim());
        list.push($("#txtEditSaleStates").val().trim());
        list.push($("#txtEditEvaluate").val().trim());
        list.push("");
        list.push($("#txtEditServiceRemark").val().trim());
        list.push($("#txtEditOrderTime").val().trim());
        list.push($("#txtEditCustomerId").val().trim());
        list.push($("#txtEditShop").val().trim());
        list.push($("#txtEditContactperson").val().trim());
        list.push($("#txtEditTelephone").val().trim());
        list.push($("#txtEditPhone").val().trim());
        list.push($("#txtEditWeixin").val().trim());
        list.push($("#txtEditQQNo").val().trim());
        list.push($("#txtEditProvinces").val().trim());
        list.push($("#txtEditCity").val().trim());
        list.push($("#txtEditCusAddress").val().trim());
        list.push($("#txtEditPayment").val().trim());
        list.push($("#txtEditAccount").val().trim());
        $.ajax({
            type: "POST",
            url: "/RetProduct/SaveTradeEdit",
            data: { "list": list },
            success: function (data) {
                $.MsgBox.Alert("提示", data);
                GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim());
            },
            error: function () {
            }
        })
    }

    /*查看按钮*/
    function LookProInfo(OrderId) {
        $("#txtSearchOrderId1").val(OrderId);
        OnSearch1();
    }

    /*删除交易信息*/
    function DeleteTrade(OrderId) {
        $.MsgBox.Confirm("提示", "确定要删除吗?", function () {
            $.ajax({
                type: "POST",
                url: "/RetProduct/DeleteTrade",
                data: { "OrderId": OrderId },
                success: function (data) {
                    if (data != "") {
                        $.MsgBox.Alert("提示", data);
                    }
                    GetTable($("#txtTiao").val().trim(), $("#selPages").val().trim());
                },
                error: function () {
                }
            })
        })
    }


    /*----------------------------------------*/

    /*搜索权限*/
    $.post("/RetProduct/GetSearchlistProInfo", { "menuId": "@ViewData["myMenuId"]" }, function (data) { $("#SearchHeader1").html(data); })

    /*搜索*/
    function OnSearch1() {
        GetTable1(1, $("#selPages1").val().trim());
        $("#txtTiao1").val(1);
        $("#PageNum1").html(1);
    }

    /*获得table*/
    function GetTable1(obj, selpages) {
        var lists = []; 
        lists.push($("#txtSearchOrderId1").val() == null ? "" : $("#txtSearchOrderId1").val().trim());
        lists.push($("#txtSearchScode").val() == null ? "" : $("#txtSearchScode").val().trim());
        lists.push($("#selSearchBrand").find("option:selected").val() == null ? "" : $("#selSearchBrand").find("option:selected").val());
        lists.push($("#txtSearchColor").val() == null ? "" : $("#txtSearchColor").val().trim());
        lists.push($("#selSearchTypeNo").find("option:selected").val() == null ? "" : $("#selSearchTypeNo").find("option:selected").val());
        lists.push($("#txtSearchSize").val() == null ? "" : $("#txtSearchSize").val().trim());
        lists.push($("#selSearchDef1").find("option:selected").val() == null ? "" : $("#selSearchDef1").find("option:selected").val());
         $.ajax({
            type: "get",
            url: "/RetProduct/SearchProInfo",
            data: { "menuId": "@ViewData["myMenuId"]", "lists": lists.join(","), "page": obj, "selpages": selpages },
            success: function (data) {
                selpages = selpages * 1;
                var tabledata = [];
                var tabledata = data.split("-*-");
                $("#mytable1").html(tabledata[0]);
                $("#AllCounts1").html(tabledata[1])
                $("#PageCount1").html(Math.ceil(tabledata[1] * 1 / selpages))
                showPic();
            },
            error: function () {
                alert("error")
            },
        })

    }
    function selPage1() {//---------设置显示数目
        $("#txtTiao1").val(1);
        $("#PageNum1").html(1);
        GetTable1(1, $("#selPages1").val().trim())
    }
    /*跳转*/
    function TurnPage1(obj) {//-----翻页---
        var pages = $("#selPages1").val().trim();
        var txtTiao = $("#txtTiao1").val().trim();
        switch (obj) {
            case 1: GetTable1(0, pages);//----首页
                $("#txtTiao1").val(1);
                $("#PageNum1").html(1)
                break;
            case 2:;//----上一页
                if (txtTiao == "1") {
                    return false;
                }
                else {
                    GetTable1($("#txtTiao1").val().trim() * 1 - 1, pages)
                    $("#txtTiao1").val(txtTiao * 1 - 1);
                    $("#PageNum1").html(txtTiao)
                }
                break;
            case 3://----下一页
                if (txtTiao == $("#PageCount1").html()) {
                    return false;
                }
                else {
                    GetTable1(txtTiao * 1 + 1, pages);
                    $("#txtTiao1").val(txtTiao * 1 + 1);
                    $("#PageNum1").html(txtTiao)
                }

                break;
            case 4: GetTable1($("#PageCount1").html(), pages);//----尾页

                $("#txtTiao1").val($("#PageCount1").html());
                $("#PageNum1").html($("#PageCount1").html())
                break;
            case 5: GetTable1(txtTiao, pages);//----跳转
                $("#PageNum1").html(txtTiao);

                break;

        }
    }

    /*添加商品信息按钮*/
    function AddClick1(obj) {
        $(".PopBg").height($(document).height());
        $(".PopBg").show();
        $("#PopAddContent1").show();
        $(".PopContent").find("input[type=text]").val("");
        $("#txtAddOrderId1").val(obj);
        $.post("/RetProduct/GetType", { "TypeNo": "" }, function (data) { $("#selAddTypeNo").html(data) });
        $.post("/RetProduct/GetBrand", { "BrandName": "" }, function (data) { $("#selAddBrand").html(data) })
    }

    /*保存添加商品信息*/
    function SaveAdd1() {
        var list = [];
        list.push($("#txtAddOrderId1").val().trim());
        list.push($("#txtAddScode").val().trim());
        list.push($("#txtAddNumber").val().trim());
        list.push($("#txtAddProDetails").val().trim());
        list.push($("#txtAddProLink").val().trim());
        list.push($("#txtAddDeliveryAttri").val().trim());
        list.push($("#txtAddLastOrderId").val().trim());
        list.push($("#txtAddSellPrice").val().trim());
        list.push($("#txtAddWarehouse").val().trim());
        list.push($("#txtAddSystemId").val().trim());
        $.post("/RetProduct/AddProductInfo", { "list": list }, function (data) { $.MsgBox.Alert("提示", data); GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); })
    }

    /*编辑商品信息*/
    function EditProductInfo(Id) {
        $(".PopBg").height($(document).height());
        $(".PopBg").show();
        $("#EditProductInfo").show();
        $.post("/RetProduct/EditProductInfo", { "Id": Id }, function (data) { $("#EditProductInfo").find(".PopContent").html(data) })
    }

    /*保存编辑商品信息*/
    function SaveProductInfoEdit(Id) {
        var list = [];
        list.push($("#txtEditOrderId1").attr("title"));
        list.push($("#txtEditOrderId1").val().trim());
        list.push($("#txtEditScode").val().trim());
        list.push($("#txtEditNumber").val().trim());
        list.push($("#txtEditProDetails").val().trim());
        list.push($("#txtEditProLink").val().trim());
        list.push($("#txtEditDeliveryAttri").val().trim());
        list.push($("#txtEditLastOrderId").val().trim());
        list.push($("#txtEditSellPrice").val().trim());
        list.push($("#txtEditWarehouse").val().trim());
        list.push($("#txtEditSystemId").val().trim());
        $.post("/RetProduct/SaveProductInfoEdit", { "list": list }, function (data) { $.MsgBox.Alert("提示", data); GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); })
    }

    /*删除商品信息*/
    function DeleteProductInfo(Id) {
        $.MsgBox.Confirm("提示", "确定要删除吗?", function () {
            $.post("/RetProduct/DeleteProductInfo", { "Id": Id }, function (data) { GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); })
        })

    }

    /*判断操作类型 1.申请退款 2.申请退货 3.申请换货 4.取消换货 5.取消退货 6.取消退款 7.发货 */
    function ReturnGoods(OrderId, Scode, type) {
        $(".PopContent").find("li").find("input").val("");
        if (type == "1") {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopAddGoods").show();
            $("#LabOrderId").html(OrderId);
            $("#LabScode").html(Scode);
            $("#txtAddRetDetails").val("");
            $("#txtAddReason").val("");
            $("#txtAddRetType").val("申请退款");
            $("#txtAddRetType").attr("title", "1");

        }
        else if (type == "2") {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopAddGoods").show();
            $("#LabOrderId").html(OrderId);
            $("#LabScode").html(Scode);
            $("#txtAddRetDetails").val("");
            $("#txtAddReason").val("");
            $("#txtAddRetType").val("申请退货");
            $("#txtAddRetType").attr("title", "2");
        }
        else if (type == "5") {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopAddGoods1").show();
            $("#LabOrderId1").html(OrderId);
            $("#LabScode1").html(Scode);
            $("#txtAddSendType1").val("发货");
            $("#txtAddSendType1").attr("title", "1");
        }
        else if (type == "6") {
            $(".PopBg").height($(document).height());
            $(".PopBg").show();
            $("#PopAddGoods").show();
            $("#LabOrderId").html(OrderId);
            $("#LabScode").html(Scode);
            $("#txtAddRetType").val("申请退货");
            $("#txtAddRetType").attr("title", "5");
        }
        else { 
            $.post("/RetProduct/CancelStatus", { "OrderId": OrderId, "Scode": Scode, "type": type }, function (data) { if (data != "") { $.MsgBox.Alert("提示", data); } GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); });
        }


    }

    /*保存退货退款*/
    function SaveGoods() {
        var list = [];
        list.push($("#LabOrderId").html());
        list.push($("#txtAddRetPrice").val().trim());
        list.push($("#txtAddRetDetails").val().trim());
        list.push($("#txtAddRetType").attr("title"));
        list.push($("#txtAddRetAccount").val().trim());
        list.push($("#LabScode").html());
        list.push($("#txtAddReason").find("option:selected").val());
        $.post("/RetProduct/ReturnGoods", { list: list, type: "1" }, function (data) { $.MsgBox.Alert("提示", data); GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); })
    }

    /*保存发货*/
    function SaveGoods1() {
        var list = [];
        list.push($("#LabOrderId1").html());
        list.push($("#txtAddExPrice1").val().trim());
        list.push($("#txtAddSendTime1").val().trim());
        list.push($("#txtAddExpress1").val().trim());
        list.push($("#txtAddExpressNo1").val().trim());
        list.push($("#txtAddYFHKD1").val().trim());
        list.push($("#txtAddYFRMB1").val().trim());
        list.push($("#txtAddRetRemark1").val().trim());
        list.push($("#txtAddSendPerson1").val().trim());
        list.push($("#txtAddSendType1").attr("title"));
        list.push($("#txtAddSendStatus1").val().trim());
        list.push($("#LabScode1").html());
        $.post("/RetProduct/ReturnGoods", { list: list, type: "2" }, function (data) { $.MsgBox.Alert("提示", data); GetTable1($("#txtTiao1").val().trim(), $("#selPages1").val().trim()); })
    }

    /*图片错误处理*/
    function errorImg(obj) {
        var src = $(obj).attr("src");
        if (src == "") {
            $(obj).parent().html("");
        }
        else {
            $(obj).parent().attr("title", src);
            $(obj).parent().html("Img error");
        }
    }

    //--显示大图
    function showPic() {
        var m = $("#mytable1,#mytable").find("img").length - 1;
        $("#mytable1,#mytable").find("img").each(function (i, j) {
            if (i == m && m != 0) {
                $(this).hover(function () {
                    var y = $(this).offset().top;
                    var x = $(this).offset().left;
                    $("#divShowPic").css("top", y - 140);
                    $("#divShowPic").css("left", x + 60);
                    var src = $(this).attr("src");
                    var Type = src.split(".")[4];
                    src = src.split("@@")[0];
                    $("#divShowPic").html("<img src='" + src + "' style='height:200px;width:200px' />")
                    ScrollPic("divShowPic");

                }, function () {
                    $("#divShowPic").html("");
                    CloseScroll();
                })
            } else {
                $(this).hover(function () {
                    var y = $(this).offset().top;
                    var x = $(this).offset().left;
                    $("#divShowPic").css("top", y);
                    $("#divShowPic").css("left", x + 60);
                    var src = $(this).attr("src");
                    var Type = src.split(".")[4];
                    src = src.split("@@")[0];
                    $("#divShowPic").html("<img src='" + src + "' style='height:200px;width:200px' />")
                    ScrollPic("divShowPic");
                }, function () {
                    $("#divShowPic").html("")
                    CloseScroll();
                })
            }

        })
    }

    /*鼠标滚轮放大*/
    function ScrollPic(obj) {
        var scrollFunc = function (e) {
            var direct = 0;
            ee = e || window.event;
            if (e.wheelDelta > 0) {
                var add = $("." + obj).find("img").css("width");
                add = parseInt(add)
                if (add < 500) {
                    $("." + obj).find("img").css("width", add + 25)
                    $("." + obj).find("img").css("height", add + 25)
                }

            }
            else {
                var add = $("." + obj).find("img").css("width");
                add = parseInt(add)
                if (add > 300) {
                    $("." + obj).find("img").css("width", add - 25)
                    $("." + obj).find("img").css("height", add - 25)
                }
            }
            $("body").css("overflow", "hidden");
            //ScrollText(direct);

        }
        //if (document.addEventListener) {
        //    document.addEventListener('DOMMouseScroll', scrollFunc, false);
        //}//W3C  
        window.onmousewheel = document.onmousewheel = scrollFunc; //IE/Opera/Chrome/Safari 
    }
    function CloseScroll() {
        $("body").css("overflow", "auto");
        window.onmousewheel = document.onmousewheel = 0; //IE/Opera/Chrome/Safari
    }
</script>
